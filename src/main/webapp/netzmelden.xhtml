<!DOCTYPE html>
<ui:composition template="/templates/layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <!-- Seitentitel für Layout -->
    <ui:define name="title">Geisternetze erfassen</ui:define>

    <ui:define name="content">
    	<div class="page-container">
    
            <!-- Hauptüberschrift -->
		    <h2 class="page-title">Geisternetze erfassen</h2>
		    
			<!-- Begleittext -->
			<p class="page-intro">
			    Auf dieser Seite können Sie ein neues Geisternetz erfassen. Bitte geben Sie die
			    erforderlichen Geokoordinaten ein, wählen Sie die passende Größe aus und entscheiden Sie,
    			ob die Meldung anonym erfolgen soll.
			</p>

			<p class="page-intro">
				Die Größe hilft dabei, den geschätzten
				Umfang und das Gewicht des Netzes einzuschätzen – von kleineren Küstennetzen (XS) 
				bis hin zu extrem großen Hochsee-Netzen (XL).			
			</p>
			
			<p class="page-intro">
			    Wenn Sie die Option „anonym“ wählen, werden Ihre persönlichen Angaben
			    automatisch gelöscht und die entsprechenden Felder deaktiviert. Wenn Sie jedoch Ihren Namen und Ihre
			    Telefonnummer angeben, erleichtert dies Rückfragen und die weitere Koordination der Bergung.
			</p>
			
			<p style="margin-bottom: 20px;">
			    Nachdem alle notwendigen Angaben gemacht wurden, können Sie das Netz über die Schaltfläche
			    <strong>„Speichern“</strong> melden.
			</p>
			
            <!-- Growl für Fehlermeldungen -->
			<p:growl id="growl" showDetail="true" life="3500" />
			
		    <h:form id="netForm">
                <!-- PanelGrid für Formulareingaben -->	
		        <h:panelGrid columns="3" cellpadding="5" columnClasses="label-column, input-column, error-column">
		            <p:outputLabel value="Breitengrad" for="latitude"/>
					<h:panelGroup layout="block" style="display: flex; align-items: center; gap: 10px;">
                        <p:inputText id="latitude" 
                        			 value="#{netBean.net.latitude}" 
                        			 required="true" 
                        			 requiredMessage="Breitengrad erforderlich" 
                  					 validatorMessage="Breitengrad muss zwischen -90 und +90 liegen."
                        			 placeholder="z. B. 52.1234">
                        	<f:validateDoubleRange minimum="-90" maximum="90"/>
                        </p:inputText>
                    </h:panelGroup>		   
                    <p:message for="latitude" display="text" />
                             
		            <p:outputLabel value="Längengrad" for="longitude"/>
					<h:panelGroup layout="block" style="display: flex; align-items: center; gap: 10px;">
                        <p:inputText id="longitude" 
                        			 value="#{netBean.net.longitude}" 
                        			 required="true" 
									 requiredMessage="Längengrad erforderlich"
									 validatorMessage="Längengrad muss zwischen -180 und +180 liegen."
                        			 placeholder="z. B. 13.5678">
                        	<f:validateDoubleRange minimum="-180" maximum="180"/>
                        </p:inputText>
                    </h:panelGroup>
					<p:message for="longitude" display="text" />
	
					<p:outputLabel value="Size" for="size"/>
					<h:panelGroup layout="block" style="display: flex; align-items: center; gap: 10px;">
                        <p:selectOneMenu id="size" 
                        				 value="#{netBean.selectedSizeId}" 
                        				 required="true" 
                        				 requiredMessage="Größe erforderlich">
                            <f:selectItem itemValue="" itemLabel="Auswählen..." />
                            <f:selectItems value="#{netBean.allSizes}" var="s" itemValue="#{s.id}" itemLabel="#{s.name}" />
                        </p:selectOneMenu>
                    </h:panelGroup>
                    <p:message for="size" display="text" />
                    
					<h:outputText id="anonymousLabel" value="Meldung anonym speichern" />
					<p:selectBooleanCheckbox id="anonymous" value="#{netBean.anonymous}" 
					    rendered="#{empty netBean.reporter.firstName and empty netBean.reporter.lastName and empty netBean.reporter.phone}">
					    <p:ajax event="change" update="personalPanel" listener="#{netBean.clearPersonalIfAnonym}" />
					</p:selectBooleanCheckbox>
					<p:outputLabel value="" for=""/>
					                    	
		        </h:panelGrid>   

                <!-- Persönliche Daten -->
		        <h:panelGrid id="personalPanel" columns="3" cellpadding="5" columnClasses="label-column, input-column, error-column">
                    <p:outputLabel value="Vorname" for="reporterFirstName"/>
					<p:inputText id="reporterFirstName" 
								 value="#{netBean.reporter.firstName}" 
								 placeholder="Optional" 
								 disabled="#{netBean.anonymous}" 
								 required="#{!netBean.anonymous}" 
								 requiredMessage="Vorname erforderlich bei nicht-anonymer Meldung" />
					<p:message for="reporterFirstName" display="text" />
					
					<p:outputLabel value="Nachname" for="reporterLastName"/>
					<p:inputText id="reporterLastName" 
								 value="#{netBean.reporter.lastName}" 
								 placeholder="Optional"
								 disabled="#{netBean.anonymous}" 
								 required="#{!netBean.anonymous}" 
								 requiredMessage="Nachname erforderlich bei nicht-anonymer Meldung" />
					<p:message for="reporterLastName" display="text" />
					
					<p:outputLabel value="Telefonnummer" for="reporterPhone"/>
					<p:inputText id="reporterPhone" 
								 value="#{netBean.reporter.phone}" 
								 placeholder="Optional"
								 disabled="#{netBean.anonymous}" 
								 required="#{!netBean.anonymous}" 
								 requiredMessage="Telefonnummer erforderlich bei nicht-anonymer Meldung">
					    <f:validator validatorId="phoneValidator" />
					</p:inputText>
					<p:message for="reporterPhone" display="text" />
					
					<h:outputText />
					<p:commandButton value="Speichern" 
									 icon="pi pi-save" 
									 action="#{netBean.reportNewNet}" 
									 update="netForm growl" 
									 process="@form" 
									 style="margin-top: 10px;"/>
		        </h:panelGrid>   
		    </h:form>
		</div>
    </ui:define>
</ui:composition>